(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{0:function(t,a){},1:function(t,a){},2:function(t,a){},3:function(t,a){},U5Xq:function(t,a,e){var i=e("bxrm");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);e("SZ7m")("14859d9e",i,!0,{})},"V/EK":function(t,a,e){"use strict";e.r(a);var i=e("Vjiq"),n=e("eC5B"),o=e.n(n),r=(e("HEbw"),{name:"laravel-echo",components:{Echo:i.a,Pusher:o.a},data:()=>({echo:null,numberNotifaction:0,arrayNotification:[],variantButton:"primary"}),mounted(){this.connect(),this.eventMe(),this.requestNotification()},watch:{numberNotifaction(t){this.variantButton=t>0?"danger":"primary"}},methods:{ver(t){this.markAsRead(t),this.$emit("openPost",t.data.publicacion.id)},liveNotification(t){let a=t.data.message,e={theme:"",position:"top-right",duration:3e3,action:[{text:"IR",onClick:(a,e)=>{this.ver(t)}}]};null==t.read_at?(e.theme="bubble",e.action.push({text:"LEIDA",onClick:(a,e)=>{this.markAsRead(t),e.goAway(0)}})):e.theme="outline",this.$toasted.show(a,e)},requestNotification(){this.arrayNotification=[],this.axios.get("api/notifications").then(t=>{this.arrayNotification=t.data;let a=this.arrayNotification.filter(t=>null==t.read_at);this.numberNotifaction=a.length})},openNotifacation(){_.each(this.arrayNotification,(t,a)=>{this.liveNotification(t)})},connect(){this.echo||(this.echo=new i.a({broadcaster:"pusher",key:"b5806fbd6f412d4ca0e2",cluster:"us2",wsHost:"www.shakur.com.ar",wsPort:6001,wssPort:6001,disableStats:!0,enabledTransports:["ws","wss"],auth:{headers:{Authorization:null}}}),this.echo.connector.pusher.connection.bind("connected",t=>this.connect(t))),this.echo.connector.pusher.config.auth.headers.Authorization="Bearer "+sessionStorage.getItem("token"),this.echo.connector.pusher.connect()},async eventMe(){let t=await this.getIdUser();this.echo.private("App.User."+t).notification(t=>{let a={data:t};this.requestNotification(),this.liveNotification(a)})},markAsRead(t){this.axios.post("api/notification",t).then(t=>{this.requestNotification()})},getIdUser(){return new Promise(t=>{this.axios.get("api/usuario").then(a=>{t(a.data.id)})})}}}),s={render:function(){var t=this.$createElement,a=this._self._c||t;return a("b-container",{staticClass:"no-padding"},[a("b-button",{attrs:{variant:this.variantButton},on:{click:this.openNotifacation}},[a("font-awesome-icon",{staticClass:"pointer",attrs:{icon:"bell"}}),this._v(" "),a("b-badge",{directives:[{name:"show",rawName:"v-show",value:this.numberNotifaction>0,expression:"numberNotifaction>0"}],attrs:{variant:"light"}},[this._v("\n                 "+this._s(this.numberNotifaction)+"\n             ")])],1)],1)},staticRenderFns:[]};var c={name:"Topbar",components:{notification:e("H/SE")(r,s,!1,function(t){e("bGDR")},"data-v-4660f8e6",null).exports},data:()=>({materias:[],username:"",avatar_url:"",materiaSelected:""}),mounted(){this.getMaterias()},filters:{formatMateriaSelected(t){if(window.innerWidth<=576){if(t.length>=25){let a=t.length-25;return(t=t.slice(0,-a))+"..."}return t}return""}},methods:{getMaterias(){this.axios.get("api/materias2/user").then(t=>{this.username=t.data.username,this.avatar_url=t.data.avatar,t.data.materias.forEach(t=>{let a={id:t.id,nombre:t.materia};this.materias.push(a)}),this.materias.length>0?this.clickMateria(this.materias[0].id):this.$emit("comunication",!0)})},clickMateria(t){_.each(this.materias,(a,e)=>{a.id==t&&(this.materiaSelected=a.nombre)}),this.$emit("changeMateria",t)},openPost(t){this.$emit("openPost",t)}}},h={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("b-navbar",{attrs:{toggleable:"md",type:"dark",variant:"info"}},[e("b-navbar-toggle",{attrs:{target:"nav_collapse"}}),t._v(" "),e("label",{staticClass:"text-center white no-margin"},[t._v(t._s(t._f("formatMateriaSelected")(t.materiaSelected)))]),t._v(" "),e("b-navbar-brand",{staticClass:"valentine",attrs:{href:"#"}},[t._v("Shakur")]),t._v(" "),e("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[e("b-navbar-nav",t._l(t.materias,function(a){return e("b-nav-item",{key:a.id,attrs:{id:"materia"},on:{click:function(e){return t.clickMateria(a.id)}}},[t._v(t._s(a.nombre))])}),1),t._v(" "),e("b-navbar-nav",{staticClass:"ml-auto"},[e("h4",[t._v(t._s(t.username)+" ")]),t._v(" "),e("b-img",{attrs:{rounded:"circle",width:"30",height:"30",src:t.avatar_url}})],1)],1),t._v(" "),e("b-navbar-brand",{staticClass:"no-padding"},[e("notification",{on:{openPost:t.openPost}})],1)],1)},staticRenderFns:[]};var l=e("H/SE")(c,h,!1,function(t){e("U5Xq")},"data-v-4b72eacc",null);a.default=l.exports},bGDR:function(t,a,e){var i=e("rAhW");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);e("SZ7m")("1d6a2af8",i,!0,{})},bxrm:function(t,a,e){(t.exports=e("I1BE")(!1)).push([t.i,".valentine[data-v-4b72eacc]{font-family:valentine!important}.white[data-v-4b72eacc]{color:#fff}.no-margin[data-v-4b72eacc]{margin-bottom:0}",""])},rAhW:function(t,a,e){(t.exports=e("I1BE")(!1)).push([t.i,".pointer[data-v-4660f8e6]{cursor:pointer}.no-padding[data-v-4660f8e6]{padding-left:0;padding-right:0}",""])}}]);